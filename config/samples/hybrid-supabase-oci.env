# ============================================================================
# HYBRID - SUPABASE + OCI (Best Value)
# ============================================================================
# Perfect for: Cost-effective production with managed database
# Setup time: 1 hour
# Monthly cost: $50-150
# Handles: 10,000-50,000 users
# Architecture: Supabase for DB+Auth, OCI for compute+cache
#
# Why This Combo:
#   ✅ Supabase: Free tier DB, easy auth, automatic backups
#   ✅ OCI: Cheap VMs (Always Free tier available), full control
#   ✅ Best of both worlds: Managed DB + flexible compute
#
# Infrastructure:
#   - Supabase: PostgreSQL database + Authentication
#   - OCI Compute: 2-4 VMs for backend (can use Always Free)
#   - OCI Compute: 1-2 VMs for workers
#   - Local Redis on VMs or small OCI Cache instance
#
# Setup Steps:
#   1. Create Supabase project (free tier)
#   2. Create OCI VM instances
#   3. Install Redis on one VM
#   4. Deploy backend and workers
#   5. Point domain to OCI Load Balancer
#
# Guide: ARCHITECTURE_FLEXIBILITY.md#scenario-4-hybrid
# ============================================================================

# Deployment Configuration
DEPLOYMENT_MODE=multi-tier
NODE_ENV=production

# Database - Supabase (Managed, Free Tier Available)
DATABASE_TYPE=supabase
SUPABASE_URL=<REPLACE_WITH_YOUR_SUPABASE_URL>
SUPABASE_ANON_KEY=<REPLACE_WITH_YOUR_ANON_KEY>
SUPABASE_SERVICE_ROLE_KEY=<REPLACE_WITH_YOUR_SERVICE_ROLE_KEY>
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=15

# Authentication - Supabase Auth (Easy, Managed)
AUTH_PROVIDER=supabase

# Workers - Bull Queue with Redis
WORKER_MODE=bull-queue
WORKER_CONCURRENCY=5
QUEUE_REDIS_URL=redis://redis-vm.internal:6379
QUEUE_PREFIX=bharatmart:queue

# Cache - Redis on OCI VM (or small OCI Cache instance)
CACHE_TYPE=redis
CACHE_REDIS_URL=redis://redis-vm.internal:6379
CACHE_TTL=600
CACHE_PREFIX=bharatmart:cache

# Alternative: Use OCI Cache for better performance
# CACHE_TYPE=oci-cache
# OCI_CACHE_ENDPOINT=<REPLACE_WITH_CACHE_ENDPOINT>

# Secrets Management
SECRETS_PROVIDER=env

# OCI Configuration (for potential vault/object storage use)
OCI_REGION=ap-mumbai-1
OCI_TENANCY_OCID=<OPTIONAL>
OCI_OBJECT_STORAGE_BUCKET=bharatmart-assets

# Server Configuration
PORT=3000
HOST=0.0.0.0
FRONTEND_URL=https://yourdomain.com

# Security
JWT_SECRET=<REPLACE_WITH_SECURE_RANDOM_64_CHAR_STRING>
CORS_ORIGIN=*
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=500

# Logging
LOG_LEVEL=info
LOG_FORMAT=json
LOG_FILE=/var/log/bharatmart/api.log

# Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# Frontend Configuration
VITE_API_URL=https://api.yourdomain.com
VITE_APP_NAME=BharatMart
VITE_SUPABASE_URL=<REPLACE_WITH_YOUR_SUPABASE_URL>
VITE_SUPABASE_ANON_KEY=<REPLACE_WITH_YOUR_ANON_KEY>

# Email Configuration
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=<REPLACE_THIS>
SMTP_PASSWORD=<REPLACE_THIS>
EMAIL_FROM=noreply@yourdomain.com

# Observability
OTEL_SERVICE_NAME=bharatmart-backend
OTEL_EXPORTER_OTLP_ENDPOINT=<OPTIONAL_OTLP_ENDPOINT>
OTEL_TRACES_SAMPLER=always_on

# Chaos Engineering (for SRE training)
CHAOS_ENABLED=false
CHAOS_LATENCY_MS=0

# Admin Seed (for db:init script)
ADMIN_EMAIL=admin@bharatmart.com
ADMIN_PASSWORD=<REPLACE_THIS>

# Monitoring (optional)
SENTRY_DSN=<OPTIONAL_SENTRY_DSN>

# Cost Optimization
# Use OCI Always Free tier: 2x E2.1.Micro VMs (1 GB RAM, 1/8 OCPU each)
# Use Supabase Free tier: 500 MB database, 1 GB bandwidth
# Total cost: $0/month for small deployments!
